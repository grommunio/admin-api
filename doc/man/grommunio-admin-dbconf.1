.\" Automatically generated by Pandoc 3.1.11.1
.\"
.TH "grommunio\-admin\-dbconf" "1" "" "" ""
.SH Name
grommunio\-admin dbconf \[em] Database\-stored configuration management.
.SH Synopsis
.PP
\f[B]grommunio\-admin dbconf\f[R] (\f[I]commit\f[R] | \f[I]delete\f[R])
\f[I]SERVICE\f[R] [\f[I]FILE\f[R] [\f[I]KEY\f[R]]]
.PD 0
.P
.PD
\f[B]grommunio\-admin dbconf\f[R] \f[I]get\f[R] \f[I]SERVICE\f[R]
\f[I]FILE\f[R] [\f[I]KEY\f[R]]
.PD 0
.P
.PD
\f[B]grommunio\-admin dbconf\f[R] \f[I]list\f[R] [\f[I]SERVICE\f[R]
[\f[I]FILE\f[R] [\f[I]KEY\f[R]]]]
.PD 0
.P
.PD
\f[B]grommunio\-admin dbconf\f[R] \f[I]set\f[R] [\f[I]\-b\f[R]]
[\f[I]\-i\f[R]] [\-\-] \f[I]SERVICE\f[R] \f[I]FILE\f[R] \f[I]KEY\f[R]
\f[I]VALUE\f[R]
.SH Description
.PP
\f[I]grommunio dbconf\f[R] provides the ability to store and manage
configurations at a single location while making it available across
distributed systems.
The configurations are stored in the central MySQL database and can be
accessed via \f[I]grommunio\-dbconf(1)\f[R] and
\f[I]grommunio\-admin\-dbconf(1)\f[R].
.PD 0
.P
.PD
While both tools essentially provide the same functionality,
\f[I]grommunio\-dbconf(1)\f[R] provides far better performance and is
intended to be used for quickly accessing the configuration.
.PP
Configurations consist of key/value pairs organized in files, grouped by
service.
Each service can have an arbitrary number of configuration files, which
in turn can contain an arbitrary number of unique keys.
.SH Commands
.TP
\f[CR]commit\f[R]
Trigger commit hook for service, file or key
.TP
\f[CR]delete\f[R]
Delete service, file or key
.TP
\f[CR]get\f[R]
Get file or single key
.TP
\f[CR]list\f[R]
List available services, files or keys
.TP
\f[CR]set\f[R]
Set a configuration key
.SH Options
.TP
\f[CR]SERVICE\f[R]
Name of the service to configure
.TP
\f[CR]FILE\f[R]
Name of the configuration file
.TP
\f[CR]KEY\f[R]
Name of the configuration key
.TP
\f[CR]VALUE\f[R]
Value to store in the key
.TP
\f[CR]\-\-\f[R]
Indicate that all options have been specified and only names follow
.TP
\f[CR]\-b\f[R], \f[CR]\-\-batch\f[R]
Do not auto\-commit
.TP
\f[CR]\-i\f[R], \f[CR]\-\-init\f[R]
Only set if configuration key does not exist yet
.SH grommunio\-admin
The grommunio\-admin API and CLI are also dbconf consumers.
This allows system adiministrators to change certain configurations
without filesystem access and the need to restart the API.
.PP
The following files and keys are meaningful when placed under the
grommunio\-admin service:
.SS multi\-server
.TP
\f[CR]policy\f[R]
Server selection policy for newly created users and domains in
multi\-server environments.
Possible values are \f[I]balanced\f[R], \f[I]first\f[R], \f[I]last\f[R],
\f[I]random\f[R] and \f[I]round\-robin\f[R].
Default is \f[I]round\-robin\f[R].
.SH Commit Hooks
When modifying values, potential consumers can be notified of this
change via commit hooks, for example by restarting the service using the
configuration.
For security reasons only a few white\-listed commands are available
(see section \f[I]AVAILABLE COMMIT COMMANDS\f[R]).
.PP
Commit hooks can be defined on \f[CR]key\f[R], \f[CR]file\f[R] or
\f[CR]service\f[R] level.
\f[I]set\f[R] operations always trigger commits at key level, while the
\f[I]commit\f[R] command can directly trigger key or service level hooks
depending on whether a file or key is specified.
.PP
If no hook is defined for a specific trigger level, it automatically
falls through to the next lower level, in the order \f[I]key\f[R] >
\f[I]file\f[R] > \f[I]service\f[R].
.PP
Commit hooks for a service can be defined by setting
\f[CR]commit_key\f[R], \f[CR]commit_file\f[R] and
\f[CR]commit_service\f[R] keys under
\f[I]grommunio\-dbconf/<service>\f[R] to a valid command (see below).
.SH Available Commit Commands
The following commands are available:
.SS Key
\f[CR]postconf \-e $ENTRY\f[R]
.SS File
\f[CR]postconf \-e $FILE_S && systemctl reload postfix\f[R]
.SS Service
.PP
\f[CR]systemctl reload $SERVICE\f[R]
.PD 0
.P
.PD
\f[CR]systemctl restart $SERVICE\f[R]
.SH Macros
As the whitelisted commands might be hard to memorize and may be changed
in the future, macros are provided that expand to whitelisted commands.
.PP
The following macros are defined:
.SS Key
\f[CR]#POSTCONF\f[R] \-> \f[CR]postconf \-e $ENTRY\f[R]
.SS File
\f[CR]#POSTCONF\f[R] \->
\f[CR]sudo postconf \-e $FILE_S && systemctl reload postfix\f[R]
.SS Service
.PP
\f[CR]#RELOAD\f[R] \-> \f[CR]systemctl reload $SERVICE\f[R]
.PD 0
.P
.PD
\f[CR]#RESTART\f[R] \-> \f[CR]systemctl restart $SERVICE\f[R]
.SH Command Variable Expansion
Commands can contain \f[I]$\f[R]\-prefixed variables that are expanded
before execution.
The literal \f[I]$$\f[R] can be used to generate a single \f[I]$\f[R].
.PP
The following variables are valid:
.TP
\f[CR]ENTRY\f[R]
Expands to \f[CR]$KEY=$VALUE\f[R] (key level only)
.TP
\f[CR]FILE\f[R]
Complete content of the modified file as newline separated key=value
entries (file level only)
.TP
\f[CR]FILE_S\f[R]
Complete content of the modified file as space separated key=value
entries (file level only)
.TP
\f[CR]FILENAME\f[R]
Name of the modified file (key and file level)
.TP
\f[CR]KEY\f[R]
The modified key (key level only)
.TP
\f[CR]SERVICE\f[R]
Name of the modified service
.TP
\f[CR]VALUE\f[R]
New value of the modified key (key level only)
.SH See Also
\f[B]grommunio\-admin\f[R](1), \f[B]grommunio\-admin\-config\f[R](1),
\f[B]grommunio\-admin\-mconf\f[R](1).
\f[B]grommunio\-dbconf\f[R](1)
